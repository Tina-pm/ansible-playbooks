# vim:ts=2:sw=2:et:ai:sts=2
---
# =============================================================================
# Reusable defaults and templates for base-setup role.
# =============================================================================

base_setup__enable: true
base_setup__set_hostname: '{{ host_fqdn }}'
base_setup__disable_cloud_init: true
base_setup__disable_resolved: true

base_setup__apt_upgrade: false
base_setup__pkg_install__base:
  - acl  # Needed for becoming a non-root user.
  - cron
  - cron-apt
  - dbus
  - linux-sysctl-defaults  # Need for non-root ping.
  - logrotate
  - mailutils
  - rsyslog

base_setup__pkg_install__utils:
  - bash-completion
  - info
  - kitty-terminfo
  - less
  - lsof
  - man
  - manpages
  - moreutils
  - ncurses-term
  - screen
  - tmux
  - vim

base_setup__pkg_install__netutils:
  - bind9-host
  - netcat-openbsd
  - rsync
  - socat
  - strace
  - tcpdump

base_setup__pkg_install__locate:
  - |-
    {{
      'mlocate' if (
        apt__distro_ver is version('11', 'lt')
        if (apt__vendor | d('debian')) == 'debian' else
        apt__distro_ver is version('22.04', 'lt')
      ) else 'plocate'
    }}

base_setup__setup_locales: true
base_setup__default_locale: en_IE.UTF-8
base_setup__locales_to_be_generated:
  - en_IE.UTF-8 UTF-8
  - en_US.UTF-8 UTF-8
  - es_AR.UTF-8 UTF-8
  - es_ES.UTF-8 UTF-8

# Agregation of custom configuration using var prefixes
# -----------------------------------------------------------------------------

base_setup__pkg_install: |-
  {{
    query('vars',
      *(query('varnames', '^base_setup__pkg_install__.*') | sort)
    ) | sum(start=[])
  }}
